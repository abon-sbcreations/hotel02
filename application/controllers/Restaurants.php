<?phpdefined('BASEPATH') OR exit('No direct script access allowed');class Restaurants extends CI_Controller {private $_hotel_restaurant = "hotel_restaurant_master";    public function __construct() {        parent::__construct();        $this->load->helper('url');        $this->load->helper('commonmisc_helper');        $this->load->helper('validationmisc_helper');        $this->load->model('Restaurant');        $u1 = $this->session->userdata('admin_user_id');         if(!isset($u1)){            redirect('/admins', 'refresh');        }    }    public function restaurant_list() {        $loggedHotelAdmin = $this->session->all_userdata();        $head02Temp = $this->load->view('templates/head02',['loggedHotelAdmin'=>$loggedHotelAdmin],TRUE);        $leftmenu02Temp = $this->load->view('templates/leftMenu02',['activeMenu'=>'restaurants/restaurant_list'],TRUE);        $this->load->view('restaurants/restaurant_list', [            'head02Temp'=>$head02Temp,            'leftmenu02Temp'=>$leftmenu02Temp,            'timeSlotOptions' => timeSlotOptions(),            'hotelOptions' =>hotelOptions(),            'sessionOption' => getSession(),            'menuTypeOption' => getMenuType(),            'availableOption' => getItemAvailable()        ]);    }    public function ajaxAllRestaurantMasterDataTable() {        // Datatables Variables        $draw = intval($this->input->get("draw"));        $start = intval($this->input->get("start"));        $length = intval($this->input->get("length"));        $restaurants = $this->Restaurant->getRestaurant(['where'=>['hr.hotel_id'=>$this->session->userdata('hotel_id')]]);        $rows = [];        foreach ($restaurants as $k => $restaurant) {            $rows[] = [                "DT_RowId" => "row_" . $restaurant['menu_id'],                "menu_id" => $restaurant['menu_id'],                "hotel_id" => $restaurant['hotel_id'],                "hotel_name" => $restaurant['hotel_name'],                                "menu_session" => $restaurant['menu_session'],                "menu_type" => $restaurant['menu_type'],                "item_name" => ucwords($restaurant['item_name']),                "item_desc" => $restaurant['item_desc'],                "item_price" => $restaurant['item_price'],                "item_available" => $restaurant['item_available'] == "Y" ? "Yes" : "No"            ];        }        echo json_encode([            "draw" => $draw,            "recordsTotal" => count($restaurants),            "recordsFiltered" => count($restaurants),            "data" => $rows        ]);    }    public function ajaxRestaurantMasterDetails() {        $params = [            'where' => ['menu_id' => $this->input->post('menu_id')]        ];        $restaurant = $this->Restaurant->getRestaurant($params);        echo json_encode($restaurant[0]);    }    public function ajaxRestaurantMasterDelete() {        $where = ['menu_id' => $this->input->post('menu_id')];        $restaurant = $this->Restaurant->deleteRestaurant($where);        return json_encode(['true']);    }    public function ajaxUniqueRestaurantAttr(){        $post = $this->input->post();        if (isset($post['primaryVal']) && !empty($post['primaryVal'])) {            echo checkHotelUnique([                'table' => $this->_hotel_restaurant,                'primary_id' => "menu_id",                'primaryVal' => $post['primaryVal'],                 'hotelIdValue'=>$this->session->userdata('hotel_id'),                'attr' => $post['attr'],                'attrVal' => $post['attrVal']                    ]);        } else {            echo checkHotelUnique([                'table' => $this->_hotel_restaurant,                'primary_id' => "menu_id",                'primaryVal' => 0,                'hotelIdValue'=>$this->session->userdata('hotel_id'),                'attr' => $post['attr'],                'attrVal' => $post['attrVal']                    ]);        }    }    public function ajaxRestaurantMasterSubmit() {        $post = $this->input->post();        if (isset($post['menu_id']) && !empty($post['menu_id'])) {            $this->Restaurant->putRestaurant($post);        } else {            $this->Restaurant->postRestaurant($post);        }    }        }